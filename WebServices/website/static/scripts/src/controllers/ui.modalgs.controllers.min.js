angular.module("ui-modalgs-controllers",["leaflet-directive","ui.bootstrap","nya.bootstrap.select","satnet-services","broadcaster"]);angular.module("ui-modalgs-controllers").controller("AddGSModalCtrl",["$scope","$log","$modalInstance","leafletData","satnetRPC","broadcaster",function(c,f,e,b,d,a){c.gs={};c.gs.identifier="";c.gs.callsign="";c.gs.elevation=DEFAULT_GS_ELEVATION;angular.extend(c,{center:{lat:DEFAULT_LAT,lng:DEFAULT_LNG,zoom:DEFAULT_ZOOM},markers:{gsMarker:{lat:DEFAULT_LAT,lng:DEFAULT_LNG,message:"Move me!",focus:true,draggable:true}}});b.getMap().then(function(g){locateUser(f,g,c.markers.gsMarker)});c.ok=function(){var g=[c.gs.identifier,c.gs.callsign,c.gs.elevation.toFixed(2),c.markers.gsMarker.lat.toFixed(6),c.markers.gsMarker.lng.toFixed(6)];d.call("gs.add",g,function(i){var h=i.groundstation_id;f.info("[map-ctrl] GS added, id = "+h);a.gsAdded(h)});e.close()};c.cancel=function(){e.close()}}]);angular.module("ui-modalgs-controllers").controller("EditGSModalCtrl",["$scope","$log","$modalInstance","leafletData","satnetRPC","broadcaster","groundstationId",function(c,g,f,b,e,a,d){c.gs={};c.center={lat:DEFAULT_LAT,lng:DEFAULT_LNG,zoom:DEFAULT_ZOOM};c.markers={};e.call("gs.get",[d],function(h){c.gs.identifier=d;c.gs.callsign=h.groundstation_callsign;c.gs.elevation=h.groundstation_elevation;angular.extend(c,{center:{lat:h.groundstation_latlon[0],lng:h.groundstation_latlon[1],zoom:DEFAULT_ZOOM},markers:{gsMarker:{lat:h.groundstation_latlon[0],lng:h.groundstation_latlon[1],message:"Move me!",focus:true,draggable:true}}})});c.update=function(){var h={groundstation_id:d,groundstation_callsign:c.gs.callsign,groundstation_elevation:c.gs.elevation.toFixed(2),groundstation_latlon:[c.markers.gsMarker.lat.toFixed(6),c.markers.gsMarker.lng.toFixed(6)]};e.call("gs.update",[d,h],function(i){g.info("[map-ctrl] GS updated, id = "+i);a.gsUpdated(i)});f.close()};c.cancel=function(){f.close()};c.erase=function(){if(confirm("Delete this ground station?")==true){e.call("gs.delete",[d],function(h){g.info("[map-ctrl] GS removed, id = "+h);a.gsRemoved(h)});f.close()}}}]);